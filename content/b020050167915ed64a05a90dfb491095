<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
<meta charset="UTF-8" />
<title>MakeItLink &#8211; Detecting URLs In Text And Making Them Links | Joseph Scott</title>
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="stylesheet" type="text/css" media="all" href="http://josephscott.org/wp-content/themes/twentyten/style.css" />
<link rel="pingback" href="http://josephscott.org/xmlrpc.php" />

<!-- Start Comment Info Tip Plugin -->
<link type="text/css" rel="stylesheet" href="http://josephscott.org/wp-content/plugins/comment-info-tip/comment-info-tip.css" />
<!-- End Comment Info Tip Plugin -->
<link rel="alternate" type="application/rss+xml" title="Joseph Scott &raquo; Feed" href="http://josephscott.org/feed/" />
<link rel="alternate" type="application/rss+xml" title="Joseph Scott &raquo; Comments Feed" href="http://josephscott.org/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Joseph Scott &raquo; MakeItLink &#8211; Detecting URLs In Text And Making Them Links Comments Feed" href="http://josephscott.org/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/feed/" />
<script type='text/javascript' src='http://josephscott.org/wp-includes/js/comment-reply.js?ver=20090102'></script>
<script type='text/javascript' src='http://josephscott.org/wp-content/plugins/comment-info-tip/comment-info-tip.js.php?ver=1.6-js1'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://josephscott.org/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://josephscott.org/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Joseph Scott' href='http://josephscott.org/' />
<link rel='start' title='PHP Garbage Collection' href='http://josephscott.org/archives/2010/09/php-garbage-collection/' />
<link rel='prev' title='Eureka! Episode 3 &#8211; Speed' href='http://josephscott.org/archives/2008/11/eureka-episode-3-speed/' />
<link rel='next' title='The Constitution of the United States: Article I &#8211; Section 5' href='http://josephscott.org/archives/2008/12/the-constitution-of-the-united-states-article-i-section-5/' />
<meta name="generator" content="WordPress 3.0.3" />
<link rel='canonical' href='http://josephscott.org/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/' />
<link rel='shortlink' href='http://wp.me/plMew-7x' />

<style type='text/css'>
#contact-form-comment-32 {
    width: 450px;
}
#url-32, #email-32, #name-32 {
	width: 300px;
}
</style>

<script src='http://wp.josephscott.org/?dm=f59b0d9edcbd89fbdcba1b3a091c3ad9&amp;action=load&amp;blogid=5&amp;siteid=1&amp;t=653579079&amp;back=http%3A%2F%2Fjosephscott.org%2Farchives%2F2008%2F11%2Fmakeitlink-detecting-urls-in-text-and-making-them-links%2F' type='text/javascript'></script><style type="text/css">
body { background-color: #446453; }
</style>
<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
</head>

<body class="single single-post postid-467">
<div id="wrapper" class="hfeed">
	<div id="header">
		<div id="masthead">
			<div id="branding" role="banner">
								<div id="site-title">
					<span>
						<a href="http://josephscott.org/" title="Joseph Scott" rel="home">Joseph Scott</a>
					</span>
				</div>
				<div id="site-description"></div>

										<img src="http://josephscott.org/wp-content/themes/twentyten/images/headers/fern.jpg" width="940" height="198" alt="" />
								</div><!-- #branding -->

			<div id="access" role="navigation">
			  				<div class="skip-link screen-reader-text"><a href="#content" title="Skip to content">Skip to content</a></div>
								<div class="menu"><ul><li ><a href="http://josephscott.org/" title="Home">Home</a></li><li class="page_item page-item-20"><a href="http://josephscott.org/code/" title="Code">Code</a><ul class='children'><li class="page_item page-item-102"><a href="http://josephscott.org/code/javascript/" title="Javascript">Javascript</a><ul class='children'><li class="page_item page-item-1356"><a href="http://josephscott.org/code/javascript/detecting-time-zone-offset/" title="Detecting Time Zone Offset">Detecting Time Zone Offset</a></li><li class="page_item page-item-114"><a href="http://josephscott.org/code/javascript/jquery-edit-in-place/" title="jQuery Edit In Place (JEIP)">jQuery Edit In Place (JEIP)</a></li></ul></li><li class="page_item page-item-22"><a href="http://josephscott.org/code/php/" title="PHP">PHP</a><ul class='children'><li class="page_item page-item-439"><a href="http://josephscott.org/code/php/php-url-routing-pur/" title="PHP URL Routing (PUR)">PHP URL Routing (PUR)</a></li><li class="page_item page-item-491"><a href="http://josephscott.org/code/php/makeitlink/" title="MakeItLink">MakeItLink</a></li></ul></li><li class="page_item page-item-959"><a href="http://josephscott.org/code/wordpress/" title="WordPress">WordPress</a><ul class='children'><li class="page_item page-item-1485"><a href="http://josephscott.org/code/wordpress/plugin-rsscloud/" title="Plugin &#8211; RSSCloud">Plugin &#8211; RSSCloud</a></li><li class="page_item page-item-963"><a href="http://josephscott.org/code/wordpress/plugin-libxml2-fix/" title="Plugin &#8211; LibXML2 Fix">Plugin &#8211; LibXML2 Fix</a></li></ul></li></ul></li><li class="page_item page-item-1142"><a href="http://josephscott.org/slides/" title="Slides">Slides</a></li><li class="page_item page-item-32"><a href="http://josephscott.org/contact/" title="Contact">Contact</a></li><li class="page_item page-item-2790"><a href="http://josephscott.org/about/" title="About">About</a></li></ul></div>
			</div><!-- #access -->
		</div><!-- #masthead -->
	</div><!-- #header -->

	<div id="main">

		<div id="container">
			<div id="content" role="main">


				<div id="nav-above" class="navigation">
					<div class="nav-previous"><a href="http://josephscott.org/archives/2008/11/eureka-episode-3-speed/" rel="prev"><span class="meta-nav">&larr;</span> Eureka! Episode 3 &#8211; Speed</a></div>
					<div class="nav-next"><a href="http://josephscott.org/archives/2008/12/the-constitution-of-the-united-states-article-i-section-5/" rel="next">The Constitution of the United States: Article I &#8211; Section 5 <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-above -->

				<div id="post-467" class="post-467 post type-post hentry category-posts tag-makeitlink tag-php tag-wordpress">
					<h1 class="entry-title">MakeItLink &#8211; Detecting URLs In Text And Making Them Links</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted on</span> <a href="http://josephscott.org/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/" title="9:00 am" rel="bookmark"><span class="entry-date">Fri 28 Nov 2008</span></a> <span class="meta-sep">by</span> <span class="author vcard"><a class="url fn n" href="http://josephscott.org/archives/author/joseph/" title="View all posts by Joseph Scott">Joseph Scott</a></span>					</div><!-- .entry-meta -->

					<div class="entry-content">
						<p>In late October Jeff Atwood wrote about <a href="http://www.codinghorror.com/blog/archives/001181.html">The Problems With URLs</a>, describing the problems of parsing out URLs in text and transforming them into links.  Here&#8217;s a simple example:</p>
<blockquote><p>
My website is at http://josephscott.org/
</p></blockquote>
<p>Would be changed into:</p>
<blockquote><p>
My website is at &lt;a href=&#8217;http://josephscott.org/&#8217;&gt;http://josephscott.org/&lt;/a&gt;
</p></blockquote>
<p>Sounds simple right?  Once you start looking at what the valid character set is for URLs things get tricky.  I won&#8217;t rehash all of items, go the <a href="http://www.codinghorror.com/blog/archives/001181.html">The Problem With URLs</a> post to see an example of some of the problems.</p>
<p>I knew that <a href="http://wordpress.org/">WordPress</a> had a <a href="http://trac.wordpress.org/browser/tags/2.6.5/wp-includes/formatting.php#L685">make_clickable</a> function (in wp-includes/formatting.php) that did this exact thing.  After testing this against some of the problems that Jeff points out it became clear that make_clickable() didn&#8217;t handle these edge cases.  I made some rather crude tweaks to the WordPress code to fix some of these and opened <a href="http://trac.wordpress.org/ticket/8300">ticket 8300</a> with my patches.  Then filosofo came along and not only cleaned up my hacks, but reduced the amount of code needed in general.  Major kudos to filosofo!</p>
<p>At this point it looks like we&#8217;ve got code to make make_clickable() work correctly with problem URLs.  I&#8217;m going to wait until after WordPress 2.7 is released to push for getting this code committed since we&#8217;re trying to get 2.7 wrapped up.</p>
<p>I got thinking, this bit of code would be really handy to have as a stand alone library.  So I pulled out the various pieces of code needed to make this work and put it together in a single PHP class: MakeItLink</p>
<pre class="brush: php; title: ;" title="">
class MakeItLink {
    protected function _link_www( $matches ) {
        $url = $matches[2];
        $url = MakeItLink::cleanURL( $url );
        if( empty( $url ) ) {
            return $matches[0];
        }

        return &quot;{$matches[1]}&lt;a href='{$url}'&gt;{$url}&lt;/a&gt;&quot;;
    }

    public function cleanURL( $url ) {
        if( $url == '' ) {
            return $url;
        }

        $url = preg_replace( &quot;|[^a-z0-9-~+_.?#=!&amp;amp;;,/:%@$*'()x80-xff]|i&quot;, '', $url );
        $url = str_replace( array( &quot;%0d&quot;, &quot;%0a&quot; ), '', $url );
        $url = str_replace( &quot;;//&quot;, &quot;://&quot;, $url );

        /* If the URL doesn't appear to contain a scheme, we
         * presume it needs http:// appended (unless a relative
         * link starting with / or a php file).
         */
        if(
            strpos( $url, &quot;:&quot; ) === false
            &amp;amp;&amp;amp; substr( $url, 0, 1 ) != &quot;/&quot;
            &amp;amp;&amp;amp; !preg_match( &quot;|^[a-z0-9-]+?.php|i&quot;, $url )
        ) {
            $url = &quot;http://{$url}&quot;;
        }

        // Replace ampersans and single quotes
        $url = preg_replace( &quot;|&amp;amp;([^#])(?![a-z]{2,8};)|&quot;, &quot;&amp;#038;$1&quot;, $url );
        $url = str_replace( &quot;'&quot;, &quot;&amp;#039;&quot;, $url );

        return $url;
    }

    public function transform( $text ) {
        $text = &quot; {$text}&quot;;

        $text = preg_replace_callback(
            '#(?])(\()?([\w]+?://(?:[\w\\x80-\\xff\#$%&amp;amp;~/\-=?@\[\](+]|[.,;:](?![\s&amp;lt;])|(?(1)\)(?![\s&amp;lt;])|\)))*)#is&amp;#039;,
            array( &amp;#039;MakeItLink&amp;#039;, &amp;#039;_link_www&amp;#039; ),
            $text
        );

        $text = preg_replace( &amp;#039;#(&lt;a&gt;]+?&amp;gt;|&amp;gt;))&lt;a&gt;]+?&amp;gt;([^&amp;gt;]+?)&lt;/a&gt;&lt;/a&gt;#i', &quot;$1$3&lt;/a&gt;&quot;, $text );
        $text = trim( $text );

        return $text;
    }
}
</pre>
<p>It&#8217;s very easy to use, just load up the text you want to search for link and call the transform method:</p>
<pre class="brush: php; title: ;" title="">
$text = MakeItLink::transform( $text );
</pre>
<p>All of this code came out of WordPress, which is licensed under the <a href="http://www.gnu.org/licenses/old-licenses/gpl-2.0.html">GPL</a>, so consider the MakeItLink code GPL as well.  If you&#8217;ve got some improvements let me know and make sure that it gets back into the original WordPress functions as well.</p>


<p>Related posts:</p><ol><li><a href='http://josephscott.org/archives/2008/11/php-url-routing-pur/' rel='bookmark' title='Permanent Link: PHP URL Routing (PUR)'>PHP URL Routing (PUR)</a></li>
<li><a href='http://josephscott.org/archives/2008/11/adding-xml-rpc-methods-to-wordpress/' rel='bookmark' title='Permanent Link: Adding XML-RPC Methods to WordPress'>Adding XML-RPC Methods to WordPress</a></li>
</ol>											</div><!-- .entry-content -->


					<div class="entry-utility">
						This entry was posted in <a href="http://josephscott.org/archives/category/posts/" title="View all posts in Posts" rel="category tag">Posts</a> and tagged <a href="http://josephscott.org/archives/tag/makeitlink/" rel="tag">makeitlink</a>, <a href="http://josephscott.org/archives/tag/php/" rel="tag">php</a>, <a href="http://josephscott.org/archives/tag/wordpress/" rel="tag">wordpress</a>. Bookmark the <a href="http://josephscott.org/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/" title="Permalink to MakeItLink &#8211; Detecting URLs In Text And Making Them Links" rel="bookmark">permalink</a>.											</div><!-- .entry-utility -->
				</div><!-- #post-## -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://josephscott.org/archives/2008/11/eureka-episode-3-speed/" rel="prev"><span class="meta-nav">&larr;</span> Eureka! Episode 3 &#8211; Speed</a></div>
					<div class="nav-next"><a href="http://josephscott.org/archives/2008/12/the-constitution-of-the-united-states-article-i-section-5/" rel="next">The Constitution of the United States: Article I &#8211; Section 5 <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
			<div id="comments">


			<h3 id="comments-title">12 Responses to <em>MakeItLink &#8211; Detecting URLs In Text And Making Them Links</em></h3>


			<ol class="commentlist">
					<li class="comment even thread-even depth-1" id="li-comment-684">
		<div id="comment-684">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/47399d85bc5dd825ebc0e9b110f153c8?s=40&amp;d=identicon&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn"><span class='commentTipWrapper' lang='684'><a href='http://www.dustindiaz.com' rel='external nofollow'>Dustin Diaz</a></span></cite> <span class="says">says:</span>		</div><!-- .comment-author .vcard -->
		
		<div class="comment-meta commentmetadata"><a href="http://josephscott.org/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/#comment-684">
			Tue 2 Dec 2008 at 1:36 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body"><p>Horray for regular expressions! :)</p>
</div>

		<div class="reply">
			<a rel='nofollow' class='comment-reply-link' href='/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/?replytocom=684#respond' onclick='return addComment.moveForm("comment-684", "684", "respond", "467")'>Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	<ul class='children'>
	<li class="comment odd alt depth-2" id="li-comment-685">
		<div id="comment-685">
		<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/582b66ad5ae1b69c7601a990cb9a661a?s=40&amp;d=identicon&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn"><span class='commentTipWrapper' lang='685'><a href='http://josephscott.org/' rel='external nofollow'>Joseph Scott</a></span></cite> <span class="says">says:</span>		</div><!-- .comment-author .vcard -->
		
		<div class="comment-meta commentmetadata"><a href="http://josephscott.org/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/#comment-685">
			Tue 2 Dec 2008 at 3:25 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body"><p>Funny comment considering your recent posts on regular expressions :-)</p>
<p>I need to start looking seriously at commenting more regex&#8217;s when using PHP&#8217;s preg_* functions.  Ugly looking regex&#8217;s can quickly turn into black boxes.</p>
</div>

		<div class="reply">
			<a rel='nofollow' class='comment-reply-link' href='/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/?replytocom=685#respond' onclick='return addComment.moveForm("comment-685", "685", "respond", "467")'>Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li>
</ul>
</li>
	<li class="comment even thread-odd thread-alt depth-1" id="li-comment-686">
		<div id="comment-686">
		<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/352dadbe545b3abaf830984fb9682155?s=40&amp;d=identicon&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn"><span class='commentTipWrapper' lang='686'><a href='http://meyerweb.com/' rel='external nofollow'>Eric Meyer</a></span></cite> <span class="says">says:</span>		</div><!-- .comment-author .vcard -->
		
		<div class="comment-meta commentmetadata"><a href="http://josephscott.org/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/#comment-686">
			Sat 6 Dec 2008 at 12:07 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body"><p>Is this library PHP5 only?  I got a bunch of errors testing it out, some of which I banished by stripping off the &#8216;protected&#8217; and &#8216;public&#8217; function labels, but even after that I ended up with a preg_replace_callback error I couldn&#8217;t resolve.</p>
<p>(And before anyone says &#8220;Just upgrade PHP already!&#8221;, that&#8217;s not always an available option.)</p>
</div>

		<div class="reply">
			<a rel='nofollow' class='comment-reply-link' href='/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/?replytocom=686#respond' onclick='return addComment.moveForm("comment-686", "686", "respond", "467")'>Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	<ul class='children'>
	<li class="comment odd alt depth-2" id="li-comment-687">
		<div id="comment-687">
		<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/582b66ad5ae1b69c7601a990cb9a661a?s=40&amp;d=identicon&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn"><span class='commentTipWrapper' lang='687'><a href='http://josephscott.org/' rel='external nofollow'>Joseph Scott</a></span></cite> <span class="says">says:</span>		</div><!-- .comment-author .vcard -->
		
		<div class="comment-meta commentmetadata"><a href="http://josephscott.org/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/#comment-687">
			Sat 6 Dec 2008 at 2:25 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body"><p>It does have PHP5&#8242;isms in it (such as the protected and public keywords), but there really isn&#8217;t anything in the code that requires PHP5.</p>
</div>

		<div class="reply">
			<a rel='nofollow' class='comment-reply-link' href='/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/?replytocom=687#respond' onclick='return addComment.moveForm("comment-687", "687", "respond", "467")'>Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li>
	<li class="comment even depth-2" id="li-comment-688">
		<div id="comment-688">
		<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/582b66ad5ae1b69c7601a990cb9a661a?s=40&amp;d=identicon&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn"><span class='commentTipWrapper' lang='688'><a href='http://josephscott.org/' rel='external nofollow'>Joseph Scott</a></span></cite> <span class="says">says:</span>		</div><!-- .comment-author .vcard -->
		
		<div class="comment-meta commentmetadata"><a href="http://josephscott.org/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/#comment-688">
			Sat 6 Dec 2008 at 4:08 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body"><p>I take that back, it looks like something did change in PHP5 for preg_replace_callback that causes it to break in PHP4.</p>
</div>

		<div class="reply">
			<a rel='nofollow' class='comment-reply-link' href='/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/?replytocom=688#respond' onclick='return addComment.moveForm("comment-688", "688", "respond", "467")'>Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li>
	<li class="comment odd alt depth-2" id="li-comment-689">
		<div id="comment-689">
		<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/582b66ad5ae1b69c7601a990cb9a661a?s=40&amp;d=identicon&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn"><span class='commentTipWrapper' lang='689'><a href='http://josephscott.org/' rel='external nofollow'>Joseph Scott</a></span></cite> <span class="says">says:</span>		</div><!-- .comment-author .vcard -->
		
		<div class="comment-meta commentmetadata"><a href="http://josephscott.org/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/#comment-689">
			Sat 6 Dec 2008 at 11:14 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body"><p>Sorry, this appears to completely my fault.  Not sure when/where, but I managed to completely botch that regex line.  I&#8217;ve updated the code in the post with the correct regex line.  I tried the corrected version (minus the protected/public keywords) with PHP4 and confirmed that it works now.</p>
<p>My apologies for the confusion.</p>
</div>

		<div class="reply">
			<a rel='nofollow' class='comment-reply-link' href='/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/?replytocom=689#respond' onclick='return addComment.moveForm("comment-689", "689", "respond", "467")'>Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li>
</ul>
</li>
	<li class="comment even thread-even depth-1" id="li-comment-690">
		<div id="comment-690">
		<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/352dadbe545b3abaf830984fb9682155?s=40&amp;d=identicon&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn"><span class='commentTipWrapper' lang='690'><a href='http://meyerweb.com/' rel='external nofollow'>Eric Meyer</a></span></cite> <span class="says">says:</span>		</div><!-- .comment-author .vcard -->
		
		<div class="comment-meta commentmetadata"><a href="http://josephscott.org/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/#comment-690">
			Sun 7 Dec 2008 at 8:15 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body"><p>Perfecto&#8211; works great!  Thanks much.  I may integrate this into my <a href="http://meyerweb.com/eric/tools/wordpress/mw_latest_tweet.html" rel="nofollow">Latest Tweet plugin</a>, depending on how much effort it will take to do so and still support the URL-shortening feature.</p>
</div>

		<div class="reply">
			<a rel='nofollow' class='comment-reply-link' href='/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/?replytocom=690#respond' onclick='return addComment.moveForm("comment-690", "690", "respond", "467")'>Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li>
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-691">
		<div id="comment-691">
		<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/b1b1c267bff44eeafbbf3e503892be52?s=40&amp;d=identicon&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn">Ryan</cite> <span class="says">says:</span>		</div><!-- .comment-author .vcard -->
		
		<div class="comment-meta commentmetadata"><a href="http://josephscott.org/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/#comment-691">
			Sat 7 Feb 2009 at 1:39 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body"><p>Hi,</p>
<p>I copied the code to my clipboard and pasted it to a PHP file. Then I removed the protected/public keywords because I have PHP4. I started testing it and it does not work for a link in parens that has no parens. The ending closing paren is included as part of the link. This is the example I was testing(hopefully it will render properly):</p>
<p>My site (<a href="http://josephscott.org" rel="nofollow">http://josephscott.org</a>)</p>
<p>If it doesn&#8217;t render properly it is this case:</p>
<p>(link)</p>
<p>Can you test this with a PHP4 version of MakeItLink? And if it works for you can you post a link to your actual class file?</p>
</div>

		<div class="reply">
			<a rel='nofollow' class='comment-reply-link' href='/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/?replytocom=691#respond' onclick='return addComment.moveForm("comment-691", "691", "respond", "467")'>Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li>
	<li class="comment even thread-even depth-1" id="li-comment-692">
		<div id="comment-692">
		<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/b1b1c267bff44eeafbbf3e503892be52?s=40&amp;d=identicon&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn">Ryan</cite> <span class="says">says:</span>		</div><!-- .comment-author .vcard -->
		
		<div class="comment-meta commentmetadata"><a href="http://josephscott.org/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/#comment-692">
			Sat 7 Feb 2009 at 2:50 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body"><p>Hi again,</p>
<p>I have reconstructed the wordpress make_clickable code to try and get this to work and it still does not work(at least on a PHP4 engine).</p>
<p>Please see MakeItLink2.php and MakeItLink3.php which can be found in this zip:</p>
<p><a href="http://pinchpile.com/makelink.zip" rel="nofollow">http://pinchpile.com/makelink.zip</a></p>
<p>MakeItLink2.php is a class for making links without taking parens into consideration. This works as expected.</p>
<p>MakeItLink3.php is a class for taking parens into account as coded in the leaner version diff for ticket 8300. This code still does not work for(on PHP4 at least) this test case:</p>
<p>My site (<a href="http://josephscott.org" rel="nofollow">http://josephscott.org</a>)</p>
<p>Can you test it on PHP 4/5 and get back to me? Thanks.</p>
</div>

		<div class="reply">
			<a rel='nofollow' class='comment-reply-link' href='/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/?replytocom=692#respond' onclick='return addComment.moveForm("comment-692", "692", "respond", "467")'>Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	<ul class='children'>
	<li class="comment odd alt depth-2" id="li-comment-693">
		<div id="comment-693">
		<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/582b66ad5ae1b69c7601a990cb9a661a?s=40&amp;d=identicon&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn"><span class='commentTipWrapper' lang='693'><a href='http://josephscott.org/' rel='external nofollow'>Joseph Scott</a></span></cite> <span class="says">says:</span>		</div><!-- .comment-author .vcard -->
		
		<div class="comment-meta commentmetadata"><a href="http://josephscott.org/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/#comment-693">
			Mon 9 Feb 2009 at 11:35 am</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body"><p>Multiple people have indicated that this code is working.  Can you confirm that your copied code is the same as what I posted?</p>
</div>

		<div class="reply">
			<a rel='nofollow' class='comment-reply-link' href='/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/?replytocom=693#respond' onclick='return addComment.moveForm("comment-693", "693", "respond", "467")'>Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li>
</ul>
</li>
	<li class="comment even thread-odd thread-alt depth-1" id="li-comment-694">
		<div id="comment-694">
		<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/b1b1c267bff44eeafbbf3e503892be52?s=40&amp;d=identicon&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn">Ryan</cite> <span class="says">says:</span>		</div><!-- .comment-author .vcard -->
		
		<div class="comment-meta commentmetadata"><a href="http://josephscott.org/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/#comment-694">
			Mon 9 Feb 2009 at 1:49 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body"><p>Hi,</p>
<p>I tested again and you are partially right. This case:</p>
<p>&#8220;My site (<a href="http://josephscott.org)" rel="nofollow">http://josephscott.org)</a>&#8221;</p>
<p>still did not work but this did:</p>
<p>&#8220;My site (<a href="http://josephscott.org" rel="nofollow">http://josephscott.org</a>) period.&#8221;</p>
<p>So I added a trailing space character to the string on line 41 and that seemed to fix the problem.</p>
<p>I am having trouble deciphering that regex. Can we not find a solution where line 41 looks like:</p>
<p>&#8220;{$text}&#8221;</p>
<p>instead of:</p>
<p>&#8221; {$text} &#8221;</p>
<p>thx</p>
</div>

		<div class="reply">
			<a rel='nofollow' class='comment-reply-link' href='/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/?replytocom=694#respond' onclick='return addComment.moveForm("comment-694", "694", "respond", "467")'>Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	<ul class='children'>
	<li class="comment odd alt depth-2" id="li-comment-695">
		<div id="comment-695">
		<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/582b66ad5ae1b69c7601a990cb9a661a?s=40&amp;d=identicon&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn"><span class='commentTipWrapper' lang='695'><a href='http://josephscott.org/' rel='external nofollow'>Joseph Scott</a></span></cite> <span class="says">says:</span>		</div><!-- .comment-author .vcard -->
		
		<div class="comment-meta commentmetadata"><a href="http://josephscott.org/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/#comment-695">
			Mon 9 Feb 2009 at 3:06 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body"><p>We welcome patches :-)</p>
</div>

		<div class="reply">
			<a rel='nofollow' class='comment-reply-link' href='/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/?replytocom=695#respond' onclick='return addComment.moveForm("comment-695", "695", "respond", "467")'>Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li>
</ul>
</li>
			</ol>



								<div id="respond">
				<h3 id="reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/archives/2008/11/makeitlink-detecting-urls-in-text-and-making-them-links/#respond" style="display:none;">Cancel reply</a></small></h3>
									<form action="http://josephscott.org/wp-comments-post.php" method="post" id="commentform">
																			<p class="comment-notes">Your email address will not be published. Required fields are marked <span class="required">*</span></p>							<p class="comment-form-author"><label for="author">Name</label> <span class="required">*</span><input id="author" name="author" type="text" value="" size="30" aria-required='true' /></p>
<p class="comment-form-email"><label for="email">Email</label> <span class="required">*</span><input id="email" name="email" type="text" value="" size="30" aria-required='true' /></p>
<p class="comment-form-url"><label for="url">Website</label><input id="url" name="url" type="text" value="" size="30" /></p>
												<p class="comment-form-comment"><label for="comment">Comment</label><textarea id="comment" name="comment" cols="45" rows="8" aria-required="true"></textarea></p>						<p class="form-allowed-tags">You may use these <abbr title="HyperText Markup Language">HTML</abbr> tags and attributes:  <code>&lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=&quot;&quot;&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=&quot;&quot;&gt; &lt;strike&gt; &lt;strong&gt; </code></p>						<p class="form-submit">
							<input name="submit" type="submit" id="submit" value="Post Comment" />
							<input type='hidden' name='comment_post_ID' value='467' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
						</p>
						<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="911db201c4" /></p>

	<p style="clear: both;" class="subscribe-to-comments">
	<input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;" />
	<label for="subscribe">Notify me of followup comments via e-mail</label>
	</p>


					</form>
							</div><!-- #respond -->
						
</div><!-- #comments -->


			</div><!-- #content -->
		</div><!-- #container -->


		<div id="primary" class="widget-area" role="complementary">
			<ul class="xoxo">

<li id="search-2" class="widget-container widget_search"><form role="search" method="get" id="searchform" action="http://josephscott.org/" >
	<div><label class="screen-reader-text" for="s">Search for:</label>
	<input type="text" value="" name="s" id="s" />
	<input type="submit" id="searchsubmit" value="Search" />
	</div>
	</form></li>		<li id="recent-posts-2" class="widget-container widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
				<li><a href="http://josephscott.org/archives/2010/12/performance-analysis-lds-org/" title="Performance Analysis: lds.org">Performance Analysis: lds.org</a></li>
				<li><a href="http://josephscott.org/archives/2010/11/android-reboot/" title="Android Reboot">Android Reboot</a></li>
				<li><a href="http://josephscott.org/archives/2010/11/php-sql-parser/" title="php-sql-parser">php-sql-parser</a></li>
				<li><a href="http://josephscott.org/archives/2010/11/server-and-client-operating-systems/" title="Server and Client Operating Systems">Server and Client Operating Systems</a></li>
				<li><a href="http://josephscott.org/archives/2010/11/shard-query/" title="shard-query">shard-query</a></li>
				</ul>
		</li><li id="recent-comments-2" class="widget-container widget_recent_comments"><h3 class="widget-title">Recent Comments</h3><ul id="recentcomments"><li class="recentcomments">Federico on <a href="http://josephscott.org/archives/2010/11/user-agent-sniffing-at-google-libraries-cdn/#comment-19358">User Agent Sniffing at Google Libraries CDN</a></li><li class="recentcomments"><span class='commentTipWrapper' lang='18471'><a href='http://alexking.org' rel='external nofollow'>Alex</a></span> on <a href="http://josephscott.org/archives/2010/09/chrome-how-being-clever-is-worse-than-being-simple/#comment-18471">Chrome, How Being Clever is Worse Than Being Simple</a></li><li class="recentcomments"><span class='commentTipWrapper' lang='18464'><a href='http://josephscott.org/' rel='external nofollow'>Joseph Scott</a></span> on <a href="http://josephscott.org/archives/2010/09/chrome-how-being-clever-is-worse-than-being-simple/#comment-18464">Chrome, How Being Clever is Worse Than Being Simple</a></li><li class="recentcomments"><span class='commentTipWrapper' lang='18455'><a href='http://vegasgeek.com' rel='external nofollow'>John Hawkins</a></span> on <a href="http://josephscott.org/archives/2010/09/chrome-how-being-clever-is-worse-than-being-simple/#comment-18455">Chrome, How Being Clever is Worse Than Being Simple</a></li><li class="recentcomments"><span class='commentTipWrapper' lang='16971'><a href='http://0x1ff.wordpress.com/2010/12/09/xmlhttprequest-xhr-uses-multiple-packets-for-http-post-joseph-scott/' rel='external nofollow'>XMLHttpRequest XHR Uses Multiple Packets for HTTP POST? | Joseph Scott &laquo; the joy of coding</a></span> on <a href="http://josephscott.org/archives/2009/08/xmlhttprequest-xhr-uses-multiple-packets-for-http-post/#comment-16971">XMLHttpRequest (XHR) Uses Multiple Packets for HTTP POST?</a></li></ul></li><li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
			<li><a href='http://josephscott.org/archives/2010/12/' title='December 2010'>December 2010</a></li>
	<li><a href='http://josephscott.org/archives/2010/11/' title='November 2010'>November 2010</a></li>
	<li><a href='http://josephscott.org/archives/2010/10/' title='October 2010'>October 2010</a></li>
	<li><a href='http://josephscott.org/archives/2010/09/' title='September 2010'>September 2010</a></li>
	<li><a href='http://josephscott.org/archives/2010/08/' title='August 2010'>August 2010</a></li>
	<li><a href='http://josephscott.org/archives/2010/07/' title='July 2010'>July 2010</a></li>
	<li><a href='http://josephscott.org/archives/2010/06/' title='June 2010'>June 2010</a></li>
	<li><a href='http://josephscott.org/archives/2010/05/' title='May 2010'>May 2010</a></li>
	<li><a href='http://josephscott.org/archives/2010/04/' title='April 2010'>April 2010</a></li>
	<li><a href='http://josephscott.org/archives/2010/03/' title='March 2010'>March 2010</a></li>
	<li><a href='http://josephscott.org/archives/2010/02/' title='February 2010'>February 2010</a></li>
	<li><a href='http://josephscott.org/archives/2010/01/' title='January 2010'>January 2010</a></li>
	<li><a href='http://josephscott.org/archives/2009/12/' title='December 2009'>December 2009</a></li>
	<li><a href='http://josephscott.org/archives/2009/11/' title='November 2009'>November 2009</a></li>
	<li><a href='http://josephscott.org/archives/2009/10/' title='October 2009'>October 2009</a></li>
	<li><a href='http://josephscott.org/archives/2009/09/' title='September 2009'>September 2009</a></li>
	<li><a href='http://josephscott.org/archives/2009/08/' title='August 2009'>August 2009</a></li>
	<li><a href='http://josephscott.org/archives/2009/07/' title='July 2009'>July 2009</a></li>
	<li><a href='http://josephscott.org/archives/2009/06/' title='June 2009'>June 2009</a></li>
	<li><a href='http://josephscott.org/archives/2009/05/' title='May 2009'>May 2009</a></li>
	<li><a href='http://josephscott.org/archives/2009/04/' title='April 2009'>April 2009</a></li>
	<li><a href='http://josephscott.org/archives/2009/03/' title='March 2009'>March 2009</a></li>
	<li><a href='http://josephscott.org/archives/2009/02/' title='February 2009'>February 2009</a></li>
	<li><a href='http://josephscott.org/archives/2009/01/' title='January 2009'>January 2009</a></li>
	<li><a href='http://josephscott.org/archives/2008/12/' title='December 2008'>December 2008</a></li>
	<li><a href='http://josephscott.org/archives/2008/11/' title='November 2008'>November 2008</a></li>
	<li><a href='http://josephscott.org/archives/2008/10/' title='October 2008'>October 2008</a></li>
		</ul>
</li><li id="categories-2" class="widget-container widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
	<li class="cat-item cat-item-3"><a href="http://josephscott.org/archives/category/asides/" title="View all posts filed under Asides">Asides</a>
</li>
	<li class="cat-item cat-item-4"><a href="http://josephscott.org/archives/category/posts/" title="View all posts filed under Posts">Posts</a>
</li>
		</ul>
</li><li id="meta-2" class="widget-container widget_meta"><h3 class="widget-title">Meta</h3>			<ul>
						<li><a href="http://josephscott.org/wp-login.php">Log in</a></li>
			<li><a href="http://josephscott.org/feed/" title="Syndicate this site using RSS 2.0">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="http://josephscott.org/comments/feed/" title="The latest comments to all posts in RSS">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="http://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.org</a></li>
						</ul>
</li>			</ul>
		</div><!-- #primary .widget-area -->

	</div><!-- #main -->

	<div id="footer" role="contentinfo">
		<div id="colophon">



			<div id="site-info">
				<a href="http://josephscott.org/" title="Joseph Scott" rel="home">
					Joseph Scott				</a>
			</div><!-- #site-info -->

			<div id="site-generator">
								<a href="http://wordpress.org/"
						title="Semantic Personal Publishing Platform" rel="generator">
					Proudly powered by WordPress.				</a>
			</div><!-- #site-generator -->

		</div><!-- #colophon -->
	</div><!-- #footer -->

</div><!-- #wrapper -->



<!-- Google Analytics -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-5800492-1");
pageTracker._trackPageview();
</script>
<!-- // Google Analytics -->

<!-- Start Quantcast tag -->
<script type="text/javascript">
_qoptions={
qacct:"p-6cyWEkkG94hjk"
};
</script>
<script type="text/javascript" src="http://edge.quantserve.com/quant.js"></script>
<noscript>
<img src="http://pixel.quantserve.com/pixel/p-6cyWEkkG94hjk.gif" style="display: none;" border="0" height="1" width="1" alt="Quantcast"/>
</noscript>
<!-- End Quantcast tag -->

<!-- Start of StatCounter Code -->
<script type="text/javascript">
var sc_project=4465310; 
var sc_invisible=1; 
var sc_partition=55; 
var sc_click_stat=1; 
var sc_security="5ae74ea6"; 
</script>

<script type="text/javascript" src="http://www.statcounter.com/counter/counter.js"></script><noscript><div class="statcounter"><a title="blogger visitor counter" href="http://www.statcounter.com/blogger/" target="_blank"><img class="statcounter" src="http://c.statcounter.com/4465310/0/5ae74ea6/1/" alt="blogger visitor counter" ></a></div></noscript>
<!-- End of StatCounter Code -->

<script type='text/javascript' src='http://josephscott.org/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://josephscott.org/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPhp.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://josephscott.org/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://josephscott.org/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<!--stats_footer_test--><script src="https://stats.wordpress.com/e-201051.js" type="text/javascript"></script>
<script type="text/javascript">
st_go({blog:'5190300',v:'ext',post:'467'});
var load_cmc = function(){linktracker_init(5190300,467,2);};
if ( typeof addLoadEvent != 'undefined' ) addLoadEvent(load_cmc);
else load_cmc();
</script>
</body>
</html>

<!-- Dynamic page generated in 0.624 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2010-12-20 07:21:52 -->
