<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
    <title>flipping typical</title>
    
    <style type="text/css" media="print">
      
      * {
        padding: 0;
        margin: 0;
        border: 0;
      }
      
      #font-nursery {
        display: block !important;
        text-align: center;
      }

      #font-nursery h3 {
        font-size: 18pt;
      }
      
      #font-nursery .text {
        font-size: 36pt;
      }
      
      #relateds {
        margin-top: 0;
      }
      
      #relateds h3 {
        font-size: 8pt;
      }
      
      #relateds .text {
        font-size: 16pt;
      }
      
      #relateds .font {
        text-align: center;
        height: 64pt;
        float: left;
        width: 33% !important;
      }
      
      .no-print {
        display: none;
      }
      
      #footer {
        width: 100%;
        text-align: center;
        clear: left;
      }
      

    </style>
    
    
    <style type="text/css" media="screen">
      * {
        padding: 0;
        margin: 0;
        border: 0;
      }

      body {
/*        background: black;*/
        text-rendering: optimizeLegibility;
      }

      h1 {
        background: black;
      }

      h2 {
        width: 300px;
      }

      #tabs {
        position: absolute;
        right: 10px;
      }
     
      div {
        outline: 0;
      }
     
      div#page {
        padding: 1px 0 0 0;
/*        background: #eee;*/
      }

      #main-font {
        
        padding-top: 0px;
        position: fixed;
        background: white;
        width: 100%;
        border-top: 1px solid #222;
        margin: -1px 0 0 0;
      /* margin-bottom: 24px; */
      }
    
      #main-font #toggle {
        position: absolute;
        left: 0;
        top: 4px;
        color: #888;
        margin-left: 0.4em;
      }

      #main-font #toggle a {
        color: #888;
        padding: 6px 0.2em 4px 0.2em;
        text-decoration: none;
        outline: 0;
/*        font-weight: bold;*/
      }

      #main-font #toggle a:hover {
        color: white;
      }

      #main-font input {
        
        text-align: center;
        background: #222;
        vertical-align: middle;
        color: white;
/*        line-height: 28px;*/
        letter-spacing: 2px;
        text-transform: uppercase;
        width: 100%;
        font-size: 24px;
        padding: 4 4px;
        border-bottom: 1px solid #222;
      }
    
      #main-font textarea {
        text-align: center;
        letter-spacing: 0;
/*        height: 96px;*/
        padding: 0 4px;
        text-rendering: optimizeLegibility;
/*      border: 1px solid #eee;*/
      }
    
      #text-preview {
        width: 100%;
        font-size: 64px;
        letter-spacing: 4px;
      }

      #about {
        outline: 0;
        position: absolute;
        right: 4px;
        font-size: 16px;
        top: 4px;
        color: #35f;
        padding: 0px 2px 0 3px;
/*        font-family: Helvetica;*/
      }

      #shuffle:hover {
        background: #e8e8e8;
      }

      #relateds {
        background: #fff url(images/top-higher-shadow.png) repeat-x 0px 0px;
        border-top: 1px solid #bbb;
        margin-top: 8em;
        padding-top: 24px;
        overflow-y: auto;
        position: relative;
      }

      #relateds h3 {
        color: #222;
        line-height: 2em;
        letter-spacing: 2px;
        font-size: 14px;
        font-weight: normal;
        text-transform: uppercase;
        white-space: nowrap;
      }


      #relateds h3 span {
        border-bottom: 1px solid #444;
      }

      #relateds .font {
        float: left;
        font-size: 28px;
        margin: 16px 16px 0px 16px;
        width: 240px;
        height: 110px;
        overflow: hidden;
        word-spacing: -2px;
        letter-spacing: 0;
        z-index: 1;
        position: relative;
        text-align: center;
/*        background: red;*/
      }

      #relateds .font:hover {
        cursor: pointer;
/*        background: #999;*/
/*        border-right: 1px solid white;
        border-top: 1px solid white;
        border-left: 1px solid white;*/
      }
      
      #relateds .font .text {
/*      border: 1px solid #eee;
        border-left: 1px solid #f9f9f9;
        border-top: 1px solid #f9f9f9;*/
        padding: 2px 4px;
/*        background: white;*/
        height: 76px;
      }
      
      #relateds .font .text:hover {
/*        border-left: 1px solid #f4f4f4;
        border-top: 1px solid #f4f4f4;
        
        border-right: 1px solid #ddd;
        border-bottom: 1px solid #ddd;*/
      }
      
      #test { margin-left: -10000px; position: fixed; }
      
      #test span {
        font-family: "Sans Serif";
        border: 1px solid #999;
      }
      
      #count {
        display: inline;
      }
      
      #footer {
        letter-spacing: 0;
        font-size: 13px;
        padding: 3em 0 1em 0;
        background: white;
        clear: both;
        text-align: center;
      }
    </style>

    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
    <link rel="icon" href="favicon.ico" type="image/x-icon" />

    <script type="text/javascript" src="javascripts/jquery.min.js"></script>
    <script type="text/javascript" src="javascripts/jquery.cookie.js"></script>
    <script type="text/javascript" src="javascripts/jquery.livequery.js"></script>
    <script type="text/javascript" src="javascripts/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="javascripts/jquery.query.js"></script>

    <script type="text/javascript" src="javascripts/fontdb.js"></script>
    <script type="text/javascript" src="http://www.google-analytics.com/ga.js"></script>
    <script type="text/javascript" src="javascripts/nbga.js"></script>

    <script type="text/javascript">
      /* NEXT
  
      tweak about copy

      onefile script .js!

      safari bugs
        zooming breaks layout
      
      more
        open.flippingtypical.com

        'list more' link - include fonts from logs
        
        windows 'Times' detection!
        
        tweaks
          - increase height on multi-line textarea
          - hit return to add font
          - slower anim
        
        SAFARI BUGS
          iphone empty bg zoom bug

        further
        - delete button?
        - drag and drop
        - log what fonts people have = related data
      */

      // http://www.mojavelinux.com/articles/javascript_hashes.html
      // hacked to be case insensitive
      function Hash()
      {
      	this.length = 0;
      	this.items = new Array();
      	for (var i = 0; i < arguments.length; i += 2) {
      		if (typeof(arguments[i + 1]) != 'undefined') {
      			this.items[arguments[i]] = arguments[i + 1];
      			this.length++;
      		}
      	}

      	this.remove = function(in_key) {
      		var tmp_value;
      		if (typeof(this.items[in_key]) != 'undefined') {
      			this.length--;
      			var tmp_value = this.items[in_key];
      			delete this.items[in_key];
      		}

      		return tmp_value;
      	}

      	this.get = function(in_key) {
      		return this.items[in_key];
      	}

      	this.set = function(in_key, in_value) {
      		if (typeof(in_value) != 'undefined') {
      			if (typeof(this.items[in_key.toUpperCase()]) == 'undefined') {
      				this.length++;
      			}

      			this.items[in_key.toUpperCase()] = in_value;
      		}

      		return in_value;
      	}

      	this.has = function(in_key) {
      		return typeof(this.items[in_key.toUpperCase()]) != 'undefined';
      	}
      }

      // http://sedition.com/perl/javascript-fy.html
      function fisherYates ( myArray ) {
        var i = myArray.length;
        if ( i == 0 ) return false;
        while ( --i ) {
           var j = Math.floor( Math.random() * ( i + 1 ) );
           var tempi = myArray[i];
           var tempj = myArray[j];
           myArray[i] = tempj;
           myArray[j] = tempi;
         }
      }

      // http://bytes.com/groups/javascript/635488
      // -prevent-text-selection-after-double-click
      function clearSelection() {
        var sel;
        if (document.selection && document.selection.empty) {
          document.selection.empty();
        } else if (window.getSelection) {
          sel = window.getSelection();
          if (sel && sel.removeAllRanges) sel.removeAllRanges();
        }
      }
      
      var used = new Hash();
      var heights = new Hash();

      var FIRST_TYPING = false;
    
      
      var added_fonts = $.cookie('fonts');
      if (added_fonts) {
        fonts = fonts.concat( added_fonts.split(',') );
      }
      
      if ($.query.get('f')) {
        fonts = fonts.concat($.query.get('f'));
      }
      
      fisherYates(fonts);

      // fonts.sort().reverse();
      
      function random_font (n) {
        var i = Math.floor(Math.random() * fonts.length);
        
        if (used.length >= fonts.length) return "No Font";

        if (used.has(fonts[i]) || is_font_absent(fonts[i])) { 
          if (n > fonts.length) return;
          return random_font(n+1);
        } else {
          used.set(fonts[i], true);
          return fonts[i];
        }
      }
      
      // FONT DETECTION

      function is_font_installed (font) {
        return ! is_font_absent(font);
      }
      
      function is_font_absent (font) {
        return absent_font(font, "Sans Serif") ||
               absent_font(font, '"Serif"');
      }
      
      function absent_font (font, comparison) {
        var t = $('#test span');
        
        t.css({ fontFamily: q(comparison) });
        var x = t.height();
        var y = t.width();
        
        t.css({ fontFamily: q(font) });
        var x2 = t.height();
        var y2 = t.width();

        heights.set(font, y2 / 2);

        return (x == x2) && (y == y2); 
      }
      
      
      // QUOTING FOR CSS
      
      function q (txt) {
        return "'" + txt + "'";
      }
      
      function unq (txt) {
        return txt.replace(/\'/gi, "");
      }
      

      function update_main(font) {
        $('#main-font').css( { fontFamily: q(font) });
        $('#main-font textarea').css( { fontFamily: q(font) } );
        $('#main-font input')
          .attr({ value: font })
          .css({ fontFamily: q(font) });
        $('#footer').css({ fontFamily: q(font) });
        
        $('#font-nursery').css({ fontFamily: q(font) });
        $('#font-nursery h3 span').text(font);
      }
      
      function setup_main () {
        var font = $.query.get('f');
        
        if (is_font_installed(font)) {
          update_main(font);
          used.set(font, true);
        } else {
          update_main(random_font(0));
        }
      }
      
      function setup_relateds () {
        $('#relateds .font:visible').remove();
        var base = $('#font-nursery .font');
        var preview_text = $('#main-font textarea').text();

        // SelectionStart and SelectionEnd

        jQuery.each(fonts, function() {
          if ( is_font_installed(this) && (! used.has(this) ) ) {
            used.set(this, true);
            var extra = base.clone();
            extra.insertAfter($('#hack'));
            extra.css( { fontFamily: q(this.toUpperCase()) });
            // extra.find('h3 span').text(this);
            extra.show();
          }
        });
                
        // why can't i do this above?
        $('#relateds .font').each(function() {
          $(this).find('h3 span').text(unq($(this).css('fontFamily')).toUpperCase());
        });
      }
      
      function height_hack () {
        $('#main-font textarea').css({ height: '' });
        var th = $('#main-font textarea').height();
        $('#main-font textarea').height((th + 4) + "px");
        
        var header = $('#main-font input').height() + $('#main-font textarea').height();
        
        $('#main-font').height(header + 'px');
        
        var window_height = $(window).height();
        $('#relateds').css({ 'marginTop': header + 'px'})
        $('#relateds').height(window_height - header - 26);
      }

      
      function resize() {
        height_hack();
        var page_width = $('body').width();
        var cols;
        var voodoo = 40;

        if      (page_width > 1800) cols = 7;        
        else if (page_width > 1500) cols = 6;
        else if (page_width > 1200) { cols = 5; voodoo = 35; }
        else if (page_width > 900) { cols = 4; voodoo = 37; }
        else if (page_width > 700) { cols = 3; voodoo = 38; }
        else if (page_width > 0)  { cols = 2; voodoo = 50; }
        else cols = 1;
        
        var width = parseInt((page_width / cols - voodoo) + "");
        
        $('#relateds .font').width(width+'px');
      }
      
      $(document).ready(function(){
        $('#test span').text("abcd<br/>efgh<br/>ijkl<br/>mnop<br/>qrst<br/>uvwx<br/>yz0_");
        
        var focused;
        
        setup_main();
        setup_relateds();
        resize();
        window.onresize = window.onscroll = resize;

        // unselect text on doubleclicks
        // $('#relateds .font').dblclick();

        $('#relateds .font').livequery('click', function (e) {
          clearSelection();
          var new_main = unq($(e.target).css('fontFamily'));
          var old_main = unq($('#main-font').css('fontFamily'));
          
          update_main(new_main);
          
          // $('#main-font h3').text(new_main);

          $(this).css( { fontFamily: q(old_main) } );
          $(this).find('h3 span').text(old_main.toUpperCase());
          
          setTimeout(height_hack, 400); // TODO animate this
          
          if ($('textarea').val() == 'flipping typical') {
            focus_textarea();
          }
                    
          clicky.log( '#flip', new_main, 'click' );
          
          // if (this.focused)
            // $("textarea").focus();

          // e.stopPropagation();
          return false;
        } );
        
        $('#az').click(function() {
          $('#related').fadeOut();
          fonts.sort().reverse();
          used = new Hash();
          used.set($("input#font-name").val(), true)
          setup_relateds();
          $('#related').fadeIn();
          resize();
        });

        var div_cache;

        function update_preview_text () {
          var pt = $("textarea").val();
          $("textarea").attr('rows', pt.split(/\n/).length);
          resize();

          if (! FIRST_TYPING && pt != 'flipping typical') {
            clicky.log( '#edit', 'entered_text', 'type' );
            FIRST_TYPING = true;
          }
          // benchmark this!
          // if (! div_cache) {
            // div_cache = $('#relateds div.text');            
          // }

          // div_cache.each(function() {
            // $(this).text(pt);
          // });
          
          $('#font-nursery div.text').text(pt);
          $('#relateds div.text').text(pt);
          
          $.cookie('preview-text', pt, { expires: 1 }); // day
          // $('#relateds div.text').height((pt * 110) + 'px');
        }

        $("textarea").keyup(update_preview_text);
        $("textarea").focus(function() {
          update_preview_text();
        });
        $("textarea").blur(function() {
        });
        

        $("input#font-name").keyup(function() {
          var font = $("input#font-name").val().toUpperCase();
          var old_main = unq($('#main-font').css('fontFamily'));

          if (font == old_main) return;

          var extra;
          
          if (is_font_installed(font)) {
            if (used.has(font)) {
              extra = $("#relateds div.font h3 span:contains('" + font + "')").parents('div.font');
            } else {
              $.cookie('fonts', 
                $.cookie('fonts') + "," + font
              );
              $.get("/added.txt?" + font);
              fonts.push(font.toUpperCase());
              var base = $('#relateds .font:first');
              extra = base.clone();
              extra.insertAfter(base);
              extra.fadeIn();
              $('#count').text( ($('#relateds .font').length + 1) + ' fonts found' );
              used.set(font, true);
            }

            update_main(font);
            extra.css( { fontFamily: q(old_main) });
            extra.find('h3 span').text( old_main );

            resize();
          }
        });

        function set_text (t, ms) {
          setTimeout(function(){
            $('textarea').text(t);
            update_preview_text();
          }, ms);
        }
        
        function append_text (t, ms) {
          setTimeout(function(){
            $('textarea').text($('textarea').text() + t);
            update_preview_text();
          }, ms);
        }

        // setTimeout(function() { // intro anim 
        //   if ($('textarea').text() == 'flipping typical') {
        // 
        //     $('textarea').text('');
        //     var i = 0;
        //     $([
        //       15, 20, 30, 40, 44, 60, 70, 80, // flipping
        //       83, // ' '
        //       100, 105, 120, 130, 140, 150, 160 // typical
        //     ]).each(function(n) {
        //       append_text("flipping typical".charAt(i++), n * 3)
        //     });
        //     
        //     // set_text('flipping typical', 3000);
        //   }
        // }, 10);
             

        var bold_is_on = false;
        $(document).bind('keydown', 'Ctrl+b', 
          function (e) {
            bold_is_on = ! bold_is_on;
            var bold_style = bold_is_on ? { 'font-weight': 'bold' }
                                        : { 'font-weight': 'normal' };
            $('textarea').css(bold_style);
            $('#relateds div.text').each(function() {
              $(this).css(bold_style);
            });
            return false; 
          }
        );
        
        var italic_is_on = false;
        $(document).bind('keydown', 'Ctrl+i', 
          function (e) {
            italic_is_on = ! italic_is_on;
            var italic_style = italic_is_on ? { 'font-style': 'italic' }
                                            : { 'font-style': 'normal' };
            $('textarea').css(italic_style);
            $('#relateds div.text').each(function() {
              $(this).css(italic_style);
            });
            return false; 
          }
        );
        
        // change 'flipping typical text if there is an alternative
        if ($.query.get('t')) {
          $('textarea').text($.query.get('t'));
          update_preview_text();   
        } else if ($.cookie('preview-text')) {
          $('textarea').text($.cookie('preview-text'));
          update_preview_text();
        }
        
        function focus_textarea () {
          $('textarea').focus();

          var ta = $('#main-font textarea');
          if (ta[0].setSelectionRange) { // screw you IE
            var len = ta.text().length;
            ta[0].setSelectionRange(len, len); // damn you safari!
          }
        }
        
        $('#count').text( ($('#relateds .font').length + 1) + ' fonts found' );
        
        focus_textarea();
        ga.config({ id: 'UA-6631803-1' }).track();
      });
    </script>
    
  </head>
  <body>
    <div id="page">
      <div class="font no-print" id="main-font">
        <div id="toggle">
          <a href="#" id="az">A-Z</a>
        </div>
        <input type="text" id="font-name" value="font name"/> <a id="about" href="about.html">wtf?</a>
        <textarea rows="1" spellcheck="false" id="text-preview">flipping typical</textarea>
      </div>
      
      <div style="clear: left;" id="test" class="no-print">
         <h2>check out how different words look in all the popular fonts on your computer</h2>
        <span></span>
      </div>
      
      
      <div id="font-nursery" style="display: none">
        <div class="font">
          <h3><span>font name</span></h3>
          <div class="text"></div>
        </div>
        
      </div>
      
      <div id="relateds">
        <div id="hack" style="display: none"></div>

        <div id="footer">
          &copy; 2009 <a href="http://sturob.com/">Stuart Robinson</a> &middot; 
          <div id="count"></div>
        </div>
        
      </div>
      
    </div>


  </body>

  <script type="text/javascript">
  var clicky = { log: function(){ return; }, goal: function(){ return; }};
  var clicky_site_id = 66362048;
  (function() {
    var s = document.createElement('script');
    s.type = 'text/javascript';
    s.async = true;
    s.src = ( document.location.protocol == 'https:' ? 'https://static.getclicky.com/js' : 'http://static.getclicky.com/js' );
    ( document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0] ).appendChild( s );
  })();
  </script>
  <noscript><p><img alt="Clicky" width="1" height="1" src="http://in.getclicky.com/66362048ns.gif" /></p></noscript>


  
</html>